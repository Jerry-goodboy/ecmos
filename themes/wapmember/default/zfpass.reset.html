{include file="member.header.html"}
{$_head_tags}
{assign var='curr_nav' value='支付密码重置'}
    <link href="{res file=css/common.css}" type="text/css" rel="stylesheet" />
    <link href="{res file=css/address.css}" type="text/css" rel="stylesheet" />


<script language = "JavaScript">

$(function(){
    $('#zf_pass').validate({
        errorPlacement: function(error, element){
            $(element).next('.field_notice').hide();
            $(element).after(error);
        },
        success       : function(label){
            label.addClass('validate_right').text('OK!');
        },
        rules : {            
            new_zfpass : {
                required   : true,
                minlength  : 6,
                maxlength  : 20,
            },
            confirm_zfpass : {
                required   : true,
                equalTo    : '#new_zfpass',
            },
            captcha:{
                 required   : true,
            }
        },
        messages : {
            new_zfpass  : {
                required   : '{$lang.no_new_pass2}',
                minlength  : '{$lang.new_pass_not_min}',
                maxlength  : '{$lang.new_pass_not_max}',
            },
            confirm_zfpass : {
                required   : '{$lang.no_new_pass}',
                equalTo    : '{$lang.twice_pass_not_match}',
            },
             captcha:{
                 required   : '验证码不能为空',
            }
        }
    });
});
</script>
<!--设置页-->
      <div class="address_con">
        <div class="address_box" >
            <div class="address_info">
                <p><span><div style="display: none;">{$lang.zf_pass_email_data}</div></span></p>
                <p>
                    <span style="font-weight: bold; color: #333; font-size:14px;">
                    {$lang.zf_email_explain1}：{$lang.zf_password_email}{$lang.zf_email_explain2}</span>
                </p>
            </div>
            <p class="oprate"><a href="javascript:send_email();" id="send_email" dialog_width="50%" class="edit_address" style="border-left: 1px solid #e8e8e8;float: right;">发送邮件</a></p>
<script>

    function send_email(){
        $.getJSON('index.php?app=my_money&act=zfreset_email', function(data){
            // 发送邮件            
            if (data==1){
                alert("密码已重置且发送到邮箱，请到邮箱查收！");
            }else
            {
                alert("密码重置错误");
            }
        });        
    }
</script>
        </div>
        <div class="address_box" >
            <form name="zf_pass" id='zf_pass' method="post">
            <div class="address_info">
            
                <p>
                    <span style="font-weight: bold; color: #333; font-size:14px;">
                    {$lang.zf_phone_explain}</span>
                </p>
                <p><span>{$lang.xinmimad}:</span>
                    <input type="password" name="new_zfpass" id="new_zfpass"/>&nbsp; 
                    <font color="#FF0000">{$lang.xiugaidexinzhifumima}</font>
                    <label class="field_notice"></label>
                </p>
                <p><span>{$lang.querenmimad}：</span>
                    <input type="password" name="confirm_zfpass" id="confirm_zfpass" />&nbsp; 
                    <font color="#FF0000">{$lang.zaishuruyici}</font>
                    <label class="field_notice"></label>
                </p>
                <p><span>{$lang.captcha}：</span>
                    <input type="text" name="captcha" />
                    <input name='tel_captcha' id='tel_captcha' type="button" value="{$lang.send_captcha}" onclick="sendMessage()" style="width: 45%;border-right: 1px solid #e8e8e8;height: 30px;margin: 5px auto;" />
                    <label class="field_notice">请输入手机验证码</label>
                </p>

<script type="text/javascript">

var InterValObj; //timer变量，控制时间
var count = 90; //间隔函数，1秒执行
var curCount;//当前剩余秒数

function sendMessage() {
  　curCount = count;
　　//设置button效果，开始计时
     $("#tel_captcha").attr("disabled", "true");
     curCount=get_Time(curCount)
     $("#tel_captcha").val(curCount + "s内输入验证码");
     InterValObj = window.setInterval(SetRemainTime, 1000); //启动计时器，1秒执行一次
　　  //向后台发送处理数据
    $.getJSON('index.php?act=sms_captcha&code=modify_pay_passwd', function(data) {
        if(data == 1)
        {
            alert('验证码已发送成功！');
        }else{
            alert('验证码发送失败，请联系管理员');
        }
    });
}

//timer处理函数
function SetRemainTime() {
    if (curCount == 0) {                
        window.clearInterval(InterValObj);//停止计时器
        $("#tel_captcha").removeAttr("disabled");//启用按钮
        $("#tel_captcha").val("重新发送验证码");
    }
    else {
        curCount--;
        curCount=get_Time(curCount);
        $("#tel_captcha").val(curCount + "s内输入验证码");
    }
}
        //timer处理函数
function get_Time(curCount) {
    if (curCount<10) {
        curCount="0"+curCount;
    }
    return curCount;
}
</script>
            </div>
                <input type="submit" style="border:#ddd solid 1px;width: 94%;margin: 10px auto;" dialog_width="90%" class="add_submit" value="{$lang.submit}" />
            </form>
        </div>
    </div>

    <iframe id='iframe_post' name="iframe_post" src="about:blank" frameborder="0" width="0" height="0"></iframe>
</div>
{include file="member.footer.html"}